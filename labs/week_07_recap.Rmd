---
title: "week7_recap"
author: "Daniel Trielli"
date: "2023-10-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Turn off scientific notation
options(scipen=999)
```

## Loading the packages

Run the codeblock below to load the packages we will need for this recap

```{r}
library(tidyverse)
library(lubridate)
library(janitor)
```

## Load Data

Run the codeblock below to load the data.

```{r}
earthquakes <- read_csv('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_month.csv')

#Setting time column as datetime
earthquakes <- earthquakes |> mutate(time = as_datetime(time))
```

#### Answer the questions below

Most questions have a code block and a space for an answer below. Write the code you think is necessary and, in the answer space, write out what you did and what was the result.

------------------------------------------------------------------------

#### **Q1** Do you notice anything different with this read_csv()? Particularly in the file name?

**A1:** We are loading a website URL instead of a file we have saved on our computer. 

------------------------------------------------------------------------

#### **Q2** How many records there are there in this dataset? What do they mean and what useful information we can gather from it, looking at the columns?

**A2:** There are 9,139 records in the dataset. The useful information this dataset gives us is the location, date, depth and magnitude of all these earthquakes.

------------------------------------------------------------------------

#### **Q3** How do I reorganize this list to see the ones that are the deepest first? What is the depth that shows up for the deepest one, and its magnitude?

```{r}
earthquakes |> 
  arrange(desc(depth))
```

**A3:** The deepest one is 643.060 and its magnitude is 4.2.

------------------------------------------------------------------------

#### **Q4** I just want to see the earthquakes with a magnitude larger than 6. How do I do that? And how many are there that fit this criteria?

```{r}
earthquakes |> 
  filter(mag > 6)
```

**A4:** There are only 12 earthquakes that meet the criteria of a magnitude larger than 6.

------------------------------------------------------------------------

#### **Q5** What about if I want to see earthquakes that have both a magnitude larger than 6 and a depth smaller than 20? How many are there in the data set that fit [both]{.underline} these criteria?

```{r}
earthquakes |> 
  filter (mag >6 & depth <20)
```

**A5:** There are now only eight earthquakes that meet both the criteria.

------------------------------------------------------------------------

#### **Q6** What about if I want to see earthquakes that either have a magnitude larger than 6 and a depth smaller than 20? How many are there in the data set that fit [either]{.underline} these criteria?

```{r}
earthquakes |> 
  filter (mag >6 | depth <20)
```

**A6:** There are 7,608 earthquakes that fit either criteria.

------------------------------------------------------------------------

#### **Q7** I'm interested in finding earthquakes that took place in Alaska. Which column should I look at? How do I use it to find all the earthquakes in Alaska? How many earthquakes took place there?

```{r}
earthquakes |> 
  filter(str_detect(place, "Alaska"))
```

**A7:** You want to look in the place column and filter by the earthquakes with the word Alaska in it. There are 2,355 earthquakes that took place in Alaska. 

------------------------------------------------------------------------

#### **Q8** I notice that there is a column called 'type', that seems to have different kinds of tremors. What is the best way to find what are all the possible types of tremors, and counting how many of each there are in this data set? What are the first two most common types of tremors in this data set?

```{r}
earthquakes |> 
  group_by(type) |> 
  summarise (
    total = n()) |> 
  arrange(desc(total))
```

**A8:** The two most common types of tremors are earthquakes and quarry blast, which have 8,936 and 127 total.

------------------------------------------------------------------------

#### **Q9** How do I calculate the average depth of each type of tremor? What is the average depth of the earthquake type in this data set? Is there anything that seems unusual or surprising in this finding?

```{r}
earthquakes |> 
  group_by(type) |> 
  summarise (
    average_depth = mean(depth)
  ) |> 
  arrange(desc(average_depth))
```

**A9:** Something that seems unusual to me is that the average depth of the explosions and quarry blasts are negative, which I'm unsure how that is possible. The earthquakes have by far the biggest average depth, which makes a ton of sense given how much of an impact they typically make.

------------------------------------------------------------------------

#### **Q10** I'm interested, in the future, to see the hours in which earthquakes happen. How can I extract the hour from the time column?

```{r}
earthquakes |> 
  mutate(hour = hour(time))
```

**A10:** From my understanding of the time listed in the dataset, most of the earthquakes in the dataset have happened in the afternoon since the majority of the hours are higher than 12.

------------------------------------------------------------------------

#### **Q11** I want to make a note of all the records in this data set that I consider serious. For my purposes, I'm thinking that all tremors that have a magnitude that is larger than 3 are serious. How do I automatically create a new column making that distinction?

```{r}
earthquakes |> 
  mutate(
    serious = case_when(
      mag > 3 ~ "Yes",
      .default = "No"
    )
  )
```

**A11:** You have to create a new column, in my case called serious, and use case_when to decipher whether that earthquake is assigned a yes or no in the serious column.

------------------------------------------------------------------------

#### **Q12** I have no idea how earthquakes work and I'm interested in seeing if there is a particular time of day in which serious earthquakes happen. How can I see that condensed in a table with all the hours in a day and all the serious earthquakes in each hour? What is the hour with fewer serious earthquakes and the one with the most serious earthquakes?

```{r}
earthquakes |> 
  mutate(
    serious = case_when(
      mag > 3 ~ "Yes",
      .default = "No"
    ), 
    hour = hour(time)) |> 
  filter(serious == "Yes") |> 
  group_by(hour) |> 
  summarise (
    total_serious = n()) |> 
  arrange(desc(total_serious))
```

**A12**: The hour with the most serious earthquakes is 8 p.m. (hour 20) and the hour with the least serious is 4 a.m. (hour 4).

------------------------------------------------------------------------

#### EXTRA Q What other questions are you interested in and how would you ask them in R?
Question 1: How many earthquakes are in California since it is considered one of the most frequent locations alongside Alaska?
```{r}
earthquakes |> 
  filter(str_detect(place, "California|CA")) |> 
  summarise(total=n())
```
Question 2: How does the average depth of the earthquakes between California and Alaska compare?
```{r}
earthquakes |> 
  filter(str_detect(place, "California|CA|Alaska")) |> 
  mutate(state = case_when(
    str_detect(place, "California|CA") ~ "California",
    str_detect(place, "Alaska") ~ "Alaska"
  )) |> 
  group_by(state) |> 
  summarise(avg_depth = mean(depth))
```
Question 3: What is the most common depth of earthquakes?
```{r}
earthquakes |> 
  group_by(depth) |> 
  summarise(total=n()) |> 
  arrange(desc(total))
```
